<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SWESMIT - Service Worker JavaScript (ES) Modules Issue Tester</title>
    <meta name="description" content="Service Worker JavaScript (ES) Modules Issue Tester">

    <link rel="stylesheet" href="/styles/normalize.css">
    <link rel="stylesheet" href="/styles/main.css">

    <link rel="manifest" href="/manifest.webmanifest">
    <meta name="theme-color" content="#FF0000">
    <link rel="apple-touch-icon" href="/images/manifest/icons/app-icon-180.png">

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-117770191-2"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-117770191-2');
    </script>
</head>

<body>
    <header>
        <h1>SWESMIT - Service Worker JavaScript (ES) Modules Issue Tester</h1>
        <p>
            <a href="https://www.appliberated.com" target="_blank" rel="noopener">By Appliberated</a> |
            <a href="https://github.com/appliberated/swesmit" target="_blank" rel="noopener">Fork me on GitHub</a>
        </p>
    </header>

    <main>
        <p id="browser"></p>
        <p id="log" class="log"></p>
    </main>

    <script src="/scripts/classic.js"></script>
    <script type="module" src="/scripts/app.js"></script>

    <script>
        if ("serviceWorker" in navigator) {
            // Register Service Worker
            window.addEventListener("load", function () {
                navigator.serviceWorker.register("/sw.js")
                    .then(reg => window.docLog(`Service Worker registration successful. Scope is ${reg.scope}`))
                    .catch(error => window.docLog(`<strong>Service Worker registration failed with ${error}</strong>`));
            });

            // Listen and log messages from Service Worker
            navigator.serviceWorker.addEventListener("message", event => window.docLog(event.data));
        } else {
            window.docLog("<strong>Service workers not supported</strong>");
        }
    </script>
</body>

</html>